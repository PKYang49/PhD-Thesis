# Materials and Methods

## Study Design

This single-center, prospective observational study was reviewed and approved by the Institutional Review Board of National Cheng Kung University Hospital (IRB No. A-BR-112-037). The primary objective was to compare blood pressure (BP) measurements obtained using an automated Korotkoff sound BP monitor (Ksens-BP), an oscillometric BP monitor (Oscillo-BP), and the auscultatory method (Auscl-BP) in patients with cardiovascular disease. All participants provided written informed consent prior to study procedures.

Based on a target concordance correlation coefficient (CCC) of 0.80, with the lower bound of the 95% confidence interval set at 0.70 and 80% power, the required sample size was estimated at 170 participants. Considering a potential dropout rate of up to 15%, the recruitment target was set at 200 participants.

## Study Population

Participants were recruited from the cardiovascular outpatient department of National Cheng Kung University Hospital, Douliu Branch, Taiwan, from October 2023 to January 2024. Inclusion criteria were age >= 18 years and at least one of the following conditions:

- Hypertension
- Diabetes mellitus (DM)
- Stroke
- Myocardial infarction (MI)
- Coronary artery disease (CAD) confirmed by coronary angiography or computed tomography with >= 50% stenosis
- Peripheral artery disease (PAD) confirmed by angiography, computed tomography, magnetic resonance imaging, or Doppler ultrasound with >= 50% stenosis
- Atrial fibrillation (AF)
- Heart failure (HF) with left ventricular ejection fraction < 50% or prior hospitalization for pulmonary edema due to HF

Exclusion criteria included upper arm injury or surgery preventing cuff placement, or the presence of an arteriovenous fistula/graft for dialysis.

## Instrumentation and Integrated Measurement Apparatus

To reduce BP variability from sequential measurements, all three modalities (Ksens-BP, Oscillo-BP, and Auscl-BP) were integrated into a single experimental assembly.

```{r fig.cap="Figure 2.1. Schematic block diagram of the integrated experimental system. (1) Controller, (2) BP cuff with embedded K-Sensor, (3) oscillometric BP device, (4) stethoscope, (5) trigger device, and (6) computer. All signals were routed through the controller to the host computer for real-time processing and storage, enabling simultaneous Ksens-BP, Oscillo-BP, and Auscl-BP acquisition under identical cuff-pressure conditions."}
fig21_path_candidates <- c(
  "output/figures/External/2-1.png",
  "outputs/figures/External/2-1.png",
  "../output/figures/External/2-1.png",
  "../outputs/figures/External/2-1.png"
)
fig21_path <- fig21_path_candidates[file.exists(fig21_path_candidates)][1]
if (is.na(fig21_path)) {
  stop(
    "'2-1.png' not found. Checked:\n",
    paste(fig21_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig21_path)
```

### Central Controller

A custom-designed controller based on an RL78H1D microcontroller unit (MCU) controlled cuff inflation/deflation, synchronized signal acquisition, and supported user operations (measurement start, date/time setting, and data review). Signals from the K-Sensor, stethoscope audio, and trigger device were routed to the controller and forwarded to a host computer for real-time computation, visualization, and storage.

### K-Sensor

The K-Sensor consisted of a semiconductor piezoresistive strain gauge mounted on a phosphor bronze base plate (approximately 25 mm diameter x 3 mm thickness), enclosed in an aluminum frame, with a biocompatible skin-contacting film. The sensor was embedded directly in a standard upper-arm cuff and positioned over the brachial artery.

```{r fig.cap="Figure 2.2. Setup of the K-Sensor BP monitor. During cuff deflation, the K-Sensor continuously captures arterial wall vibrations associated with Korotkoff sounds. The signal is transmitted to a pretrained host-computer model to determine Ksens-BP."}
fig22_path_candidates <- c(
  "output/figures/External/2-2.png",
  "outputs/figures/External/2-2.png",
  "../output/figures/External/2-2.png",
  "../outputs/figures/External/2-2.png"
)
fig22_path <- fig22_path_candidates[file.exists(fig22_path_candidates)][1]
if (is.na(fig22_path)) {
  stop(
    "'2-2.png' not found. Checked:\n",
    paste(fig22_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig22_path)
```

### Ksens-BP Acquisition

During each automated Ksens-BP measurement, cuff pressure and K-Sensor vibration signals were recorded synchronously. The cuff was inflated to a suprasystolic level and deflated in a controlled manner. A pretrained classification model was applied to the deflation-period K-Sensor waveform to detect Korotkoff-related segments (label 1 for Korotkoff sound present, label 0 for absent). These labels were mapped to the simultaneously recorded cuff-pressure trace. Ksens-SBP was defined at the first segment labeled 1 (onset of Korotkoff sounds), and Ksens-DBP at the last segment labeled 1 (disappearance of Korotkoff sounds). When needed, cuff pressure at these time points was obtained by time alignment and interpolation.

```{r fig.cap="Figure 2.3. Schematic diagram of the Ksens-BP determination process. (a) Representative recording of cuff pressure during inflation/deflation and the simultaneously acquired K-Sensor waveform. (b) Automated discrimination of Korotkoff-related pulses within the K-Sensor signal during cuff deflation. (c) SBP and DBP are derived by mapping cuff pressure at the first and last detected Korotkoff pulses, respectively."}
fig23a_path_candidates <- c(
  "output/figures/External/2-3a.png",
  "outputs/figures/External/2-3a.png",
  "../output/figures/External/2-3a.png",
  "../outputs/figures/External/2-3a.png"
)
fig23b_path_candidates <- c(
  "output/figures/External/2-3b.png",
  "outputs/figures/External/2-3b.png",
  "../output/figures/External/2-3b.png",
  "../outputs/figures/External/2-3b.png"
)
fig23c_path_candidates <- c(
  "output/figures/External/2-3c.png",
  "outputs/figures/External/2-3c.png",
  "../output/figures/External/2-3c.png",
  "../outputs/figures/External/2-3c.png"
)
fig23a_path <- fig23a_path_candidates[file.exists(fig23a_path_candidates)][1]
fig23b_path <- fig23b_path_candidates[file.exists(fig23b_path_candidates)][1]
fig23c_path <- fig23c_path_candidates[file.exists(fig23c_path_candidates)][1]
if (is.na(fig23a_path) || is.na(fig23b_path) || is.na(fig23c_path)) {
  stop(
    "'2-3a.png / 2-3b.png / 2-3c.png' not found."
  )
}
knitr::include_graphics(c(fig23a_path, fig23b_path, fig23c_path))
```

### Oscillometric Device Integration

An Omron HEM-907 fully automated oscillometric sphygmomanometer (Omron Healthcare, Kyoto, Japan) was used as the oscillometric comparator. The Omron tubing was connected to the same cuff with embedded K-Sensor to ensure identical cuff pressure conditions. Oscillo-BP values were read from the device after deflation and recorded by research staff.

### Auscultatory BP

A standard medical-grade stethoscope diaphragm was positioned over the antecubital fossa and fixed with an elastic strap. The stethoscope acoustic signal was routed through a bifurcated circuit and converted to an electrical signal for controller input. During each measurement, trained healthcare personnel listened to Korotkoff sounds and pressed a handheld trigger button for each detected Korotkoff sound, from first sound (SBP) to last sound (DBP). The host computer automatically recorded Auscl-BP values according to trigger timing and corresponding cuff pressure.

To minimize bias, the auscultating healthcare professional and the host-computer operator were separated. The auscultating professional was blinded to real-time signals and computed BP values.

## Experimental Protocol

All measurements were performed in a quiet, temperature-controlled room, with participants seated and rested for at least 5 minutes before data collection. The sequence was:

1. Cuff inflation to 180 mmHg (or higher if baseline BP exceeded this level).
2. Controlled deflation at approximately 5 mmHg/s.
3. During deflation, simultaneous K-Sensor signal recording and auscultatory trigger marking for Ksens-BP and Auscl-BP derivation.
4. After complete deflation, on-screen Oscillo-BP values were recorded.
5. Three consecutive measurements per participant with a 1-minute rest interval; failed measurements were repeated, allowing up to five attempts.

```{r fig.cap="Figure 2.4. Actual equipment setup and signal acquisition workflow for the automated K-sound blood pressure monitoring system. Left panel: integrated platform with central controller (Label 1) streaming synchronized signals to a laptop (Label 5) for automated K-sound detection and Ksens-BP estimation, with Auscl-BP displayed for reference. Right panel: measurement components and controller inputs, including cuff pressure, stethoscope audio (Label 3), K-Sensor signal (Label 2), and operator trigger signal (Label 4)."}
fig24_path_candidates <- c(
  "output/figures/External/2-4.png",
  "outputs/figures/External/2-4.png",
  "../output/figures/External/2-4.png",
  "../outputs/figures/External/2-4.png"
)
fig24_path <- fig24_path_candidates[file.exists(fig24_path_candidates)][1]
if (is.na(fig24_path)) {
  stop(
    "'2-4.png' not found. Checked:\n",
    paste(fig24_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig24_path)
```

## Statistical Analysis

All analyses were performed in R (Version 4.5.2) (R Foundation for Statistical Computing, Vienna, Austria). Continuous variables are presented as mean +/- SD and categorical variables as n (%).

Agreement between devices and the auscultatory reference was evaluated using Lin's concordance correlation coefficient (CCC) with 95% confidence intervals and Bland-Altman analysis (mean bias and 95% limits of agreement). Method differences were summarized by mean difference, SD, and mean absolute difference, and absolute errors were compared using paired Wilcoxon signed-rank tests.

Factors associated with measurement differences were assessed using linear mixed-effects models with participant-level random intercepts. Subgroup analyses were also performed using mixed-effects models with estimated marginal means.

Oscillo-BP error was analyzed at attempt and patient levels using descriptive comparisons and logistic regression models (mixed-effects logistic model for attempt-level data and standard logistic model for patient-level data). Odds ratios with 95% confidence intervals are reported. All tests were two-sided, and p < 0.05 was considered statistically significant.


