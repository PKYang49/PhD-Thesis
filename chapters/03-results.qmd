# Results

## Study Population

```{r fig.cap="Figure 3-1. Study flow from enrollment to the final paired analytic dataset."}
fig31_path_candidates <- c(
  "output/figures/3-1.png",
  "outputs/figures/3-1.png",
  "../output/figures/3-1.png",
  "../outputs/figures/3-1.png"
)
fig31_path <- fig31_path_candidates[file.exists(fig31_path_candidates)][1]
if (is.na(fig31_path)) {
  stop(
    "'3-1.png' not found. Checked:\n",
    paste(fig31_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig31_path)
```

As shown in Figure 3-1, a total of 197 patients contributed 891 blood pressure measurement attempts during the study period. Seven attempts were excluded before device feasibility analysis because of human operation error (n = 3) or severe tremor (n = 4), leaving 884 attempts for feasibility evaluation. Among these, additional attempts were excluded due to Oscillo-BP measurement failure (n = 143), Ksens-BP acquisition error (n = 61), or concurrent failure of both devices (n = 6). The final analytic dataset therefore comprised 686 successful paired measurements from 178 patients.

```{r}
library(readr)
library(gt)

table1_path_candidates <- c(
  "outputs/tables/table 3-1.csv",
  "../outputs/tables/table 3-1.csv"
)
table1_path <- table1_path_candidates[file.exists(table1_path_candidates)][1]
if (is.na(table1_path)) {
  stop(
    "'table 3-1.csv' not found. Checked:\n",
    paste(table1_path_candidates, collapse = "\n")
  )
}

table1 <- read_csv(table1_path, show_col_types = FALSE, na = "NA")
table1 <- table1 |>
  dplyr::mutate(
    dplyr::across(
      where(is.character),
      ~ gsub("\\+/-", "\u00B1", .x)
    )
  )

label_mean_sd <- if (knitr::is_html_output()) {
  html("mean&nbsp;&plusmn;&nbsp;SD<br>or n(%)")
} else {
  "mean +/- SD or n(%)"
}

table1_caption <- if (knitr::is_html_output()) {
  md("**Table 3-1. Baseline characteristics of the study population.**")
} else {
  "Table 3-1. Baseline characteristics of the study population."
}

table1 |>
  gt() |>
  tab_caption(table1_caption) |>
  cols_align(align = "left", columns = 1) |>
  cols_align(align = "right", columns = 2) |>
  cols_label(`mean +/- SD or n(%)` = label_mean_sd) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  ) |>
  tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = Variable,
      rows = Variable %in% c("Demographics", "Anthropometrics", "Comorbidities")
    )
  )
```

Table 3-1 summarizes the baseline characteristics of the enrolled cohort. The mean age was 67.39 +/- 9.61 years, and 142 participants (79.8%) were male. The mean height, body weight, and body mass index were 164.15 +/- 8.05 cm, 71.43 +/- 13.52 kg, and 26.38 +/- 3.89 kg/m2, respectively. Hypertension was the most prevalent comorbidity (129, 72.5%), followed by coronary artery disease (90, 50.6%), diabetes mellitus (69, 38.8%), and a history of acute myocardial infarction (61, 34.3%). Heart failure and atrial fibrillation were present in 27 (15.2%) and 28 (15.7%) participants, whereas stroke (7, 3.9%) and peripheral arterial disease (6, 3.4%) were less common.

## Agreement and Systematic Differences Between Devices

```{r}
table2_path_candidates <- c(
  "outputs/tables/table 3-2.csv",
  "outputs/tables/table3-2.csv",
  "outputs/tables/table3-2_ccc.csv",
  "../outputs/tables/table 3-2.csv",
  "../outputs/tables/table3-2.csv",
  "../outputs/tables/table3-2_ccc.csv"
)
table2_path <- table2_path_candidates[file.exists(table2_path_candidates)][1]
if (is.na(table2_path)) {
  stop(
    "'table 3-2.csv / table3-2.csv / table3-2_ccc.csv' not found. Checked:\n",
    paste(table2_path_candidates, collapse = "\n")
  )
}

table2 <- read_csv(table2_path, show_col_types = FALSE, na = "NA")
table2_caption <- if (knitr::is_html_output()) {
  md("**Table 3-2. Agreement metrics between devices.**")
} else {
  "Table 3-2. Agreement metrics between devices."
}
table2 |>
  gt() |>
  tab_caption(table2_caption) |>
  cols_align(align = "left", columns = 1) |>
  cols_align(align = "right", columns = 2) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(
      columns = `device comparison`,
      rows = `device comparison` %in% c("SBP", "DBP")
    )
  ) |>
  sub_missing(missing_text = "")
```

Table 3-2 demonstrates strong agreement between each index device and the auscultatory reference, with consistently higher concordance for Ksens-BP than for Oscillo-BP. For systolic blood pressure, the concordance correlation coefficient (CCC) was 0.957 (95% CI, 0.950-0.962) for K-SYS versus C-SYS and 0.903 (95% CI, 0.888-0.916) for O-SYS versus C-SYS. A similar pattern was observed for diastolic blood pressure, with CCC values of 0.946 (95% CI, 0.937-0.953) for K-DIA versus C-DIA and 0.851 (95% CI, 0.831-0.869) for O-DIA versus C-DIA.

```{r fig.cap="Figure 3-2A. Bland-Altman plot for systolic BP: Oscillo-BP versus auscultatory reference."}
fig32a_path_candidates <- c(
  "output/figures/3-2a.png",
  "outputs/figures/3-2a.png",
  "../output/figures/3-2a.png",
  "../outputs/figures/3-2a.png"
)
fig32a_path <- fig32a_path_candidates[file.exists(fig32a_path_candidates)][1]
if (is.na(fig32a_path)) {
  stop(
    "'3-2a.png' not found. Checked:\n",
    paste(fig32a_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig32a_path)
```

```{r fig.cap="Figure 3-2B. Bland-Altman plot for systolic BP: Ksens-BP versus auscultatory reference."}
fig32b_path_candidates <- c(
  "output/figures/3-2b.png",
  "outputs/figures/3-2b.png",
  "../output/figures/3-2b.png",
  "../outputs/figures/3-2b.png"
)
fig32b_path <- fig32b_path_candidates[file.exists(fig32b_path_candidates)][1]
if (is.na(fig32b_path)) {
  stop(
    "'3-2b.png' not found. Checked:\n",
    paste(fig32b_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig32b_path)
```

```{r fig.cap="Figure 3-3A. Bland-Altman plot for diastolic BP: Oscillo-BP versus auscultatory reference."}
fig33a_path_candidates <- c(
  "output/figures/3-3a.png",
  "outputs/figures/3-3a.png",
  "../output/figures/3-3a.png",
  "../outputs/figures/3-3a.png"
)
fig33a_path <- fig33a_path_candidates[file.exists(fig33a_path_candidates)][1]
if (is.na(fig33a_path)) {
  stop(
    "'3-3a.png' not found. Checked:\n",
    paste(fig33a_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig33a_path)
```

```{r fig.cap="Figure 3-3B. Bland-Altman plot for diastolic BP: Ksens-BP versus auscultatory reference."}
fig33b_path_candidates <- c(
  "output/figures/3-3b.png",
  "outputs/figures/3-3b.png",
  "../output/figures/3-3b.png",
  "../outputs/figures/3-3b.png"
)
fig33b_path <- fig33b_path_candidates[file.exists(fig33b_path_candidates)][1]
if (is.na(fig33b_path)) {
  stop(
    "'3-3b.png' not found. Checked:\n",
    paste(fig33b_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig33b_path)
```


Bland-Altman plots (Figures 3-2A, 3-2B, 3-3A, and 3-3B) were concordant with these results. For systolic pressure, Ksens-BP showed a small positive bias with narrower limits of agreement (mean difference, 0.93 mmHg; limits of agreement, -8.91 to 10.76 mmHg) compared with Oscillo-BP (mean difference, 0.59 mmHg; limits of agreement, -14.17 to 15.35 mmHg). For diastolic pressure, Ksens-BP again demonstrated tighter dispersion and minimal bias (mean difference, 0.41 mmHg; limits of agreement, -7.64 to 8.46 mmHg), whereas Oscillo-BP showed a larger negative bias and wider limits (mean difference, -4.23 mmHg; limits of agreement, -15.85 to 7.40 mmHg), indicating systematic underestimation relative to auscultatory measurements.

```{r}
table33_path_candidates <- c(
  "outputs/tables/table3-3.csv",
  "../outputs/tables/table3-3.csv"
)
table33_path <- table33_path_candidates[file.exists(table33_path_candidates)][1]
if (is.na(table33_path)) {
  stop(
    "'table3-3.csv' not found. Checked:\n",
    paste(table33_path_candidates, collapse = "\n")
  )
}
table33 <- read_csv(table33_path, show_col_types = FALSE, na = "NA")
table33_caption <- if (knitr::is_html_output()) {
  md("**Table 3-3. Systematic differences and absolute differences.**")
} else {
  "Table 3-3. Systematic differences and absolute differences."
}
table33 |>
  gt() |>
  tab_caption(table33_caption) |>
  cols_align(align = "left",  columns = 1) |>
  cols_align(align = "right", columns = 2:5) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  ) |>
  sub_missing(missing_text = "")
```

Consistent with the agreement analyses, Table 3-3 showed smaller absolute differences for Ksens-BP than for Oscillo-BP in both pressure domains. For systolic measurements, the mean absolute difference was 2.0 mmHg for Ksens-BP versus 4.4 mmHg for Oscillo-BP; for diastolic measurements, the corresponding values were 2.3 and 5.4 mmHg. Mean signed differences further indicated directionality of bias: Oscillo-BP was near-neutral for systolic pressure (+0.6 mmHg) but substantially underestimated diastolic pressure (-4.2 mmHg), whereas Ksens-BP remained close to zero for both systolic (+0.9 mmHg) and diastolic (+0.4 mmHg) readings. The between-device comparisons favored Ksens-BP for both systolic and diastolic performance (both p < 0.001).

## Factors Influencing Measurement Differences

```{r}
table34_path_candidates <- c(
  "outputs/tables/table3-4_sbp_mixedmodel.csv",
  "../outputs/tables/table3-4_sbp_mixedmodel.csv"
)
table34_path <- table34_path_candidates[file.exists(table34_path_candidates)][1]
if (is.na(table34_path)) {
  stop(
    "'table3-4_sbp_mixedmodel.csv' not found. Checked:\n",
    paste(table34_path_candidates, collapse = "\n")
  )
}
table34 <- read_csv(table34_path, show_col_types = FALSE, na = "NA")
names(table34)[3] <- "p_oscillo"
names(table34)[5] <- "p_ksens"
table34_caption <- if (knitr::is_html_output()) {
  md("**Table 3-4. Mixed-effects model for systolic BP difference.**")
} else {
  "Table 3-4. Mixed-effects model for systolic BP difference."
}
table34 |>
  gt() |>
  tab_caption(table34_caption) |>
  cols_label(
    p_oscillo = "p",
    p_ksens = "p"
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  )
```

```{r}
table35_path_candidates <- c(
  "outputs/tables/table3-5_dbp_mixedmodel.csv",
  "../outputs/tables/table3-5_dbp_mixedmodel.csv"
)
table35_path <- table35_path_candidates[file.exists(table35_path_candidates)][1]
if (is.na(table35_path)) {
  stop(
    "'table3-5_dbp_mixedmodel.csv' not found. Checked:\n",
    paste(table35_path_candidates, collapse = "\n")
  )
}
table35 <- read_csv(table35_path, show_col_types = FALSE, na = "NA")
names(table35)[3] <- "p_oscillo"
names(table35)[5] <- "p_ksens"
table35_caption <- if (knitr::is_html_output()) {
  md("**Table 3-5. Mixed-effects model for diastolic BP difference.**")
} else {
  "Table 3-5. Mixed-effects model for diastolic BP difference."
}
table35 |>
  gt() |>
  tab_caption(table35_caption) |>
  cols_label(
    p_oscillo = "p",
    p_ksens = "p"
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  )
```

Tables 3-4 and 3-5 summarize mixed-effects models evaluating clinical factors associated with measurement differences versus the auscultatory reference. For systolic differences (Table 3-4), male sex was independently associated with larger Oscillo-SBP differences (beta = 2.92 mmHg, 95% CI 1.00 to 4.84; p = 0.003), whereas no corresponding association was observed for Ksens-SBP (beta = -0.03 mmHg, 95% CI -1.03 to 0.98; p = 0.959). No other covariates reached statistical significance for systolic differences in either device model, although diabetes showed a borderline inverse association in the Ksens-SBP model (beta = -0.75 mmHg, 95% CI -1.56 to 0.06; p = 0.070).

For diastolic differences (Table 3-5), none of the prespecified covariates were statistically significant at the 0.05 level in either device model. In the Ksens-DBP model, higher heart rate showed a borderline negative association with measurement differences (beta = -0.03 mmHg per bpm, 95% CI -0.06 to 0.00; p = 0.052). In the Oscillo-DBP model, atrial fibrillation tended to be associated with larger positive differences (beta = 2.26 mmHg, 95% CI -0.17 to 4.69; p = 0.069), but this did not reach conventional significance. Overall, these findings suggest limited and outcome-specific covariate effects, with the most robust signal observed for sex-related variation in Oscillo-based systolic measurements.

## Subgroup Analyses

```{r fig.cap="Figure 3-4. Forest plot of subgroup analyses for systolic absolute differences."}
fig34_path_candidates <- c(
  "output/figures/3-4forest_SYS_absdiff_subgroups.png",
  "outputs/figures/3-4forest_SYS_absdiff_subgroups.png",
  "../output/figures/3-4forest_SYS_absdiff_subgroups.png",
  "../outputs/figures/3-4forest_SYS_absdiff_subgroups.png"
)
fig34_path <- fig34_path_candidates[file.exists(fig34_path_candidates)][1]
if (is.na(fig34_path)) {
  stop(
    "'3-4forest_SYS_absdiff_subgroups.png' not found. Checked:\n",
    paste(fig34_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig34_path)
```

```{r fig.cap="Figure 3-5. Forest plot of subgroup analyses for diastolic absolute differences."}
fig35_path_candidates <- c(
  "output/figures/3-5forest_DIA_absdiff_subgroups.png",
  "outputs/figures/3-5forest_DIA_absdiff_subgroups.png",
  "../output/figures/3-5forest_DIA_absdiff_subgroups.png",
  "../outputs/figures/3-5forest_DIA_absdiff_subgroups.png"
)
fig35_path <- fig35_path_candidates[file.exists(fig35_path_candidates)][1]
if (is.na(fig35_path)) {
  stop(
    "'3-5forest_DIA_absdiff_subgroups.png' not found. Checked:\n",
    paste(fig35_path_candidates, collapse = "\n")
  )
}
knitr::include_graphics(fig35_path)
```

Figures 3-4 and 3-5 summarize subgroup analyses of comparative device performance across hypertension, diabetes, other atherosclerotic cardiovascular disease, peripheral arterial disease (PAD), atrial fibrillation, and heart-rate strata. For systolic absolute error (Figure 3-4), the subgroup-specific estimates were consistently below zero, indicating that Ksens-BP maintained smaller absolute systolic deviation from the auscultatory reference than Oscillo-BP across all prespecified subgroups. No significant between-level contrasts were observed for systolic outcomes (all p > 0.05), suggesting no strong effect modification.

For diastolic absolute error (Figure 3-5), the overall pattern also favored Ksens-BP, but heterogeneity was evident in selected subgroups. Significant subgroup differences were observed for diabetes (Yes vs No: beta = -1.52 mmHg, 95% CI -2.76 to -0.28; p = 0.016) and PAD (Yes vs No: beta = 5.07 mmHg, 95% CI 1.59 to 8.55; p = 0.005), whereas contrasts by hypertension, other ASCVD, atrial fibrillation, and heart-rate tertiles were not significant. These findings indicate that the comparative diastolic advantage of Ksens-BP was generally robust but varied in magnitude according to specific comorbidity profiles.

## Omron Error Analysis

```{r}
table36_path_candidates <- c(
  "outputs/tables/table3-6omron_error_descripitive_attempt.csv",
  "../outputs/tables/table3-6omron_error_descripitive_attempt.csv"
)
table36_path <- table36_path_candidates[file.exists(table36_path_candidates)][1]
if (is.na(table36_path)) {
  stop(
    "'table3-6omron_error_descripitive_attempt.csv' not found. Checked:\n",
    paste(table36_path_candidates, collapse = "\n")
  )
}
table36 <- read_csv(table36_path, show_col_types = FALSE, na = "NA")
table36_caption <- if (knitr::is_html_output()) {
  md("**Table 3-6. Omron error descriptive summary (attempt-level).**")
} else {
  "Table 3-6. Omron error descriptive summary (attempt-level)."
}
table36 |>
  gt() |>
  tab_caption(table36_caption) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  )
```

```{r}
table37_path_candidates <- c(
  "outputs/tables/table3-7omron_error_descripitive_patent.csv",
  "../outputs/tables/table3-7omron_error_descripitive_patent.csv"
)
table37_path <- table37_path_candidates[file.exists(table37_path_candidates)][1]
if (is.na(table37_path)) {
  stop(
    "'table3-7omron_error_descripitive_patent.csv' not found. Checked:\n",
    paste(table37_path_candidates, collapse = "\n")
  )
}
table37 <- read_csv(table37_path, show_col_types = FALSE, na = "NA")
table37_caption <- if (knitr::is_html_output()) {
  md("**Table 3-7. Omron error descriptive summary (patient-level).**")
} else {
  "Table 3-7. Omron error descriptive summary (patient-level)."
}
table37 |>
  gt() |>
  tab_caption(table37_caption) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  )
```

Tables 3-6 and 3-7 show a consistent risk profile for Omron measurement error at both the attempt and patient levels. Compared with non-error observations, error events were associated with older age, smaller arm circumference, lower BMI, and higher heart rate, with the largest standardized imbalance observed for atrial fibrillation. At the attempt level, atrial fibrillation was substantially more frequent in error attempts (39.9% vs 12.8%; SMD = 0.65), and similar enrichment was observed at the patient level (33.9% vs 7.6%; SMD = 0.69). Peripheral artery disease was also more prevalent among error attempts, whereas diabetes and composite ASCVD were less frequent in the error group.

```{r}
table38_path_candidates <- c(
  "outputs/tables/table3-8omron_error_logistic_attempt.csv",
  "../outputs/tables/table3-8omron_error_logistic_attempt.csv"
)
table38_path <- table38_path_candidates[file.exists(table38_path_candidates)][1]
if (is.na(table38_path)) {
  stop(
    "'table3-8omron_error_logistic_attempt.csv' not found. Checked:\n",
    paste(table38_path_candidates, collapse = "\n")
  )
}
table38 <- read_csv(table38_path, show_col_types = FALSE, na = "NA")
table38_caption <- if (knitr::is_html_output()) {
  md("**Table 3-8. Mixed-effects logistic regression for Omron error (attempt-level).**")
} else {
  "Table 3-8. Mixed-effects logistic regression for Omron error (attempt-level)."
}
table38 |>
  gt() |>
  tab_caption(table38_caption) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  )
```

```{r}
table39_path_candidates <- c(
  "outputs/tables/table3-9omron_error_logistic_patient.csv",
  "../outputs/tables/table3-9omron_error_logistic_patient.csv"
)
table39_path <- table39_path_candidates[file.exists(table39_path_candidates)][1]
if (is.na(table39_path)) {
  stop(
    "'table3-9omron_error_logistic_patient.csv' not found. Checked:\n",
    paste(table39_path_candidates, collapse = "\n")
  )
}
table39 <- read_csv(table39_path, show_col_types = FALSE, na = "NA")
table39_caption <- if (knitr::is_html_output()) {
  md("**Table 3-9. Logistic regression for Omron error (patient-level).**")
} else {
  "Table 3-9. Logistic regression for Omron error (patient-level)."
}
table39 |>
  gt() |>
  tab_caption(table39_caption) |>
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  )
```



Multivariable regression analyses (Tables 3-8 and 3-9) identified atrial fibrillation as the most robust independent correlate of Omron error. In the mixed-effects attempt-level model, atrial fibrillation was associated with markedly increased odds of error (OR, 13.35; 95% CI, 3.00-59.45; p < 0.001), while age, heart rate, arm circumference, sex, and PAD were not statistically significant after adjustment. In the patient-level logistic model, atrial fibrillation remained strongly associated with error (OR, 4.63; 95% CI, 1.91-11.24; p < 0.001), and older age also emerged as an independent predictor (OR per 1 SD, 1.52; 95% CI, 1.04-2.22; p = 0.029). Smaller arm circumference showed a borderline inverse association (OR per 1 SD, 0.72; 95% CI, 0.50-1.02; p = 0.064), and heart rate remained directionally positive but non-significant.
